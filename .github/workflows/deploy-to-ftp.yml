name: Deploy to FTP

on:
  push:
    branches:
      - main
    paths:
      # Only trigger on changes to these paths
      - 'assets/**'
      - '*.html'
      - '*.php'
      - '*.css'
      - '*.js'
      - '.github/workflows/deploy-to-ftp.yml'

jobs:
  deploy:
    runs-on: ubuntu-latest
    name: Deploy to Production FTP

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Sync to FTP
        uses: SamKirkland/FTP-Deploy-Action@v4.3.5
        with:
          # FTP server details (stored in GitHub Secrets)
          server: ${{ secrets.FTP_HOST }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          
          # Remote directory (typically your public_html or www directory)
          server-dir: /public_html/
          
          # Local directory to deploy (deploy entire repo)
          local-dir: ./
          
          # Dangerous: removes remote files not in local repo
          # Set to false to keep old files
          dangerous-clean-slate: false
          
          # Exclude files from deployment
          exclude: |
            **/.git*
            **/node_modules/**
            **/.env
            **/.env.local
            **/.DS_Store
            **/README.md
            **/ReadMe.md
            **/Roadmap.md
            **/ARCHITECTURE.md
            **/COLLECTION_SETUP.md
            **/*.md
            **/.gitignore
            **/package.json
            **/package-lock.json
            **/*.py

      - name: Deployment Status
        if: always()
        run: |
          if [ ${{ job.status }} == 'success' ]; then
            echo "✅ Successfully deployed to FTP"
          else
            echo "❌ Deployment failed"
          fi
